<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Juego de Memoria</title>
<style>
    @font-face {
        font-family: 'Riffic';
        src: url('fonts/RifficFree-Bold.ttf') format('truetype');
    }
    body {
        font-family: 'Riffic', sans-serif;
        text-align: center;
        background-color: #54B435;
        margin: 0;
        padding: 20px;
        color: black;
    }
    h1 {
        color: #FFE61B;
        font-size: 2.5em;
        margin-bottom: 10px;
    }
    #timer-container {
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 15px;
    }
    #timer-bar {
        width: 200px;
        height: 20px;
        background-color: rgba(255,255,255,0.4);
        border-radius: 10px;
        overflow: hidden;
        margin-right: 10px;
    }
    #timer-fill {
        height: 100%;
        background-color: #FFE61B;
        width: 100%;
        transition: width 1s linear;
    }
    #timer-number {
        font-size: 18px;
        font-weight: bold;
    }
    .grid {
        display: grid;
        grid-template-columns: repeat(5, 100px);
        grid-gap: 10px;
        justify-content: center;
    }
    .card {
        width: 100px;
        height: 120px;
        background-color: #FFE61B;
        color: black;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
        cursor: pointer;
        border-radius: 8px;
        user-select: none;
        transition: transform 0.3s ease;
    }
    .flipped {
        background-color: white;
    }
    .hidden {
        background-color: #FFE61B;
        color: transparent;
    }
    /* Animaci√≥n de mezcla */
    @keyframes shuffle {
        0%, 100% { transform: translate(0,0) rotate(0deg); }
        25% { transform: translate(10px,-10px) rotate(5deg); }
        50% { transform: translate(-10px,10px) rotate(-5deg); }
        75% { transform: translate(5px,-5px) rotate(3deg); }
    }
    /* Modal */
    #modal {
        display: none;
        position: fixed;
        top: 0; left: 0;
        width: 100%; height: 100%;
        background: rgba(0,0,0,0.6);
        justify-content: center;
        align-items: center;
    }
    #modal-content {
        background: white;
        padding: 20px 30px;
        border-radius: 12px;
        font-size: 20px;
        max-width: 300px;
        text-align: center;
    }
</style>
</head>
<body>

<h1>Juego de Memoria</h1>

<div id="timer-container">
    <div id="timer-bar"><div id="timer-fill"></div></div>
    <div id="timer-number">10</div>
</div>

<div class="grid" id="grid"></div>

<!-- Modal -->
<div id="modal">
    <div id="modal-content"></div>
</div>

<script>
const premiosBase = [
    "Cartuchera","Cartuchera",
    "Premio Sorpresa","Premio Sorpresa",
    "Nada","Nada","Nada","Nada",
    "Mochila","Mochila",
    "10% Descuento","10% Descuento"
];

let cartas = [...premiosBase];
let primerCarta = null;
let segundoCarta = null;
let fase = "memorizar";
let tiempoMemorizar = 10;
let tiempoAdivinar = 10;
let intervaloTiempo;

const grid = document.getElementById("grid");
const timerFill = document.getElementById("timer-fill");
const timerNumber = document.getElementById("timer-number");
const modal = document.getElementById("modal");
const modalContent = document.getElementById("modal-content");

function mezclar(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
}

function crearCartas(mostrarPremio = false) {
    grid.innerHTML = "";
    cartas.forEach((premio, index) => {
        const card = document.createElement("div");
        card.classList.add("card");
        if (mostrarPremio) {
            card.textContent = premio;
            card.classList.add("flipped");
        } else {
            card.textContent = "";
            card.classList.add("hidden");
        }
        card.dataset.premio = premio;
        card.dataset.index = index;
        card.addEventListener("click", voltearCarta);
        grid.appendChild(card);
    });
}

function voltearCarta() {
    if (fase !== "adivinar" || this.classList.contains("flipped")) return;
    if (primerCarta && segundoCarta) return;

    this.classList.remove("hidden");
    this.classList.add("flipped");
    this.textContent = this.dataset.premio;

    if (!primerCarta) {
        primerCarta = this;
    } else {
        segundoCarta = this;
        clearInterval(intervaloTiempo); // Detener tiempo
        setTimeout(() => {
            if (primerCarta.dataset.premio === segundoCarta.dataset.premio) {
                mostrarModal("üéâ ¬°Ganaste! Premio: " + primerCarta.dataset.premio);
            } else {
                mostrarModal("‚ùå Ups... no era ese par.");
            }
            fase = "terminado";
        }, 500);
    }
}

function iniciarTemporizador(duracion, callback) {
    let tiempo = duracion;
    timerNumber.textContent = tiempo;
    timerFill.style.width = "100%";
    intervaloTiempo = setInterval(() => {
        tiempo--;
        timerNumber.textContent = tiempo;
        timerFill.style.width = (tiempo / duracion) * 100 + "%";
        if (tiempo <= 0) {
            clearInterval(intervaloTiempo);
            callback();
        }
    }, 1000);
}

function iniciarJuego() {
    mezclar(cartas);
    crearCartas(true);

    iniciarTemporizador(tiempoMemorizar, () => {
        document.querySelectorAll(".card").forEach(card => {
            card.style.animation = "shuffle 0.3s ease-in-out 3";
        });

        setTimeout(() => {
            mezclar(cartas);
            crearCartas(false);
            fase = "adivinar";
            iniciarTemporizador(tiempoAdivinar, () => {
                if (fase !== "terminado") {
                    mostrarModal("‚è≥ Se acab√≥ el tiempo.");
                    fase = "terminado";
                }
            });
        }, 900);
    });
}

function mostrarModal(mensaje) {
    modalContent.textContent = mensaje;
    modal.style.display = "flex";
}

iniciarJuego();
</script>

</body>
</html>
